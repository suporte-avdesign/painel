!function(t,e){t.fn.loadTableCategories=function(){var e=Handlebars.compile(t("#painel-"+tableCategory.id).html()),a=t("#"+tableCategory.id).DataTable({processing:!0,serverSide:!0,ajax:{url:tableCategory.url,type:"POST",dataType:"json",headers:{"X-CSRF-TOKEN":tableCategory.token}},sScrollX:!0,sScrollXInner:"100%",buttons:["reset"],sPaginationType:"full_numbers",iDisplayLength:tableCategory.limit,sDom:'CB<"clear"><"dataTables_header"lfr>t<"dataTables_footer"ip>',fnDrawCallback:function(e){tableCategory.tableStyled||(t("#"+tableCategory.id).closest(".dataTables_wrapper").find(".dataTables_length select").addClass("select "+tableCategory.color+" glossy").styleSelect(),t("#btn-reset").addClass(tableCategory.color+" glossy"),tableCategory.tableStyled=!0)},columns:[{data:"order",className:"align-center"},{data:"name"},{data:"section"},{data:"visits",className:"align-center"},{data:"description"},{data:"active",className:"align-center"},{data:null,className:"details-control",orderable:!1,searchable:!1,defaultContent:""}],order:[[0,"asc"]]});t("#"+tableCategory.id).on("click",tableCategory.openDetails,function(){if(event.target===this){var o=t(this).closest("tr"),s=a.row(o);s.child.isShown()?(s.child.hide(),o.removeClass("shown"),o.children().removeClass(tableCategory.colorSel)):(s.child(e(s.data())).show(),o.addClass("shown"),o.children().addClass(tableCategory.colorSel))}}),formCategory=function(e){var o,s=t("#form-"+tableCategory.id),n=s.attr("action");o="create"==e?tableCategory.txtSave:tableCategory.txtUpdate,t.ajax({type:"POST",dataType:"json",url:n,data:s.serialize(),beforeSend:function(){setBtn(4,"Aguarde",!1,"loader","btn-modal",!1,"silver")},success:function(s){if(1==s.success){if("create"==e){var n=t("#count_category").text(),l=parseFloat(n)+1;t("#count_category").text(l)}setBtn(4,o,!0,"icon-publish","btn-modal",!1,"blue"),a.ajax.reload(),msgNotifica(!0,s.message,!0,!1),fechaModal()}else setBtn(4,o,!0,"icon-publish","btn-modal",!1,"blue"),msgNotifica(!1,s.message,!0,!1)},error:function(t){setBtn(4,o,!0,"icon-publish","btn-modal",!1,"blue"),ajaxFormError(t)}})},deleteCategory=function(e,o){t.modal.confirm(tableCategory.txtConfirm+" "+o+"?",function(){t.ajax({type:"DELETE",dataType:"json",headers:{"X-CSRF-TOKEN":tableCategory.token},url:e,success:function(e){if(1==e.success){var o=t("#count_category").text(),s=parseFloat(o)-1;t("#count_category").text(s);var n=t("#count_colors").html(),l=parseFloat(n)-e.deleted.total_colors;t("#count_colors").html(l);var r=t("#count_product").html(),i=parseFloat(r)-e.deleted.total_products;t("#count_product").html(i),a.ajax.reload(),msgNotifica(!0,e.message,!0,!1)}else msgNotifica(!1,e.message,!0,!1)},error:function(t){ajaxFormError(xhr)}})},function(){t.modal.alert(tableCategory.txtCancel)})},typeGrideCategory=function(e){"unit"===e&&(t("#grid-name").show(),t("#grid-unit").show(),t("#grid-kit").hide()),"kit"===e&&(t("#grid-name").show(),t("#grid-kit").show(),t("#grid-unit").hide())},plusUndCategory=function(){t("#plus-unit").append('<span class="puls_grid input margin-right"><input type="text" name="label[]" value="" size="4" class="input-unstyled"><button onclick="removeGridCategory(this,\'.puls_grid\');" class="remove-unit button red-gradient icon-minus" title="'+tableCategory.texDelete+'"></button></span>')},plusKitCategory=function(){t("#plus-kit").append('<p class="puls_grid button-height inline-small-label"><span class="input"><input type="text" name="qty[]" class="amount input-unstyled input-sep" placeholder="'+tableCategory.texQty+'" value="0" maxlength="3" style="width: 30px;"><input type="text" name="des[]" class="input-unstyled" placeholder="'+tableCategory.txtDesc+'" value="" style="width: 80px;"><button onclick="removeGridCategory(this,\'.puls_grid\')" class="remove button red-gradient icon-minus" title="'+tableCategory.texDelete+'"></button></span></p>'),sumGridsCategory()},removeGridCategory=function(e,a){t(e).parents(a).remove()},sumGridsCategory=function(){var e=document.getElementsByClassName("amount"),a=[].map.call(e,function(t){return parseInt(t.value)}).reduce(function(t,e){return t+e});t("#total-grids").text(a)},formGridCategory=function(e,a,o,s,n,l){var r=t("#form-"+o),i=r.attr("action");t.ajax({type:"POST",dataType:"json",url:i,data:r.serialize(),beforeSend:function(){setBtn(4,n,!1,"loader","btn-modal",!1,"silver")},success:function(a){1==a.success?t("#load-grids-"+e).load(s,function(){msgNotifica(!0,a.message,!0,!1)}):(setBtn(4,l,!0,"icon-outbox","btn-modal",!1,"blue"),msgNotifica(!1,a.message,!0,!1))},error:function(t){setBtn(4,l,!0,"icon-outbox","btn-modal",!1,"blue"),ajaxFormError(t)}})},deleteGridCategory=function(e,a,o,s){t.modal.confirm(tableCategory.txtRemove+" "+a+"?",function(){t.ajax({type:"DELETE",dataType:"json",headers:{"X-CSRF-TOKEN":s},url:o,success:function(a){1==a.success?(t("#grid_"+e).hide(),msgNotifica(!0,a.message,!0,!1)):msgNotifica(!1,a.message,!0,!1)},error:function(t){ajaxFormError(t)}})},function(){t.modal.alert(tableCategory.txtCancel)})},preview_image=function(e,a){t("#image_preview_"+e).html("");for(var o=document.getElementById("upload_file").files.length,s=0;s<o;s++)t("#image_preview_"+e).append('<img src="'+URL.createObjectURL(event.target.files[s])+'" width="'+a+'">');t("#btn-upload-submit").show()},statusImage=function(e,a,o){t.ajax({type:"POST",dataType:"json",headers:{"X-CSRF-TOKEN":o},url:a,data:{_method:"put"},beforeSend:function(){t("#status-"+e).attr("class","button disabled")},success:function(a){1==a.success?(t("#status-"+e).attr("class",a.class),msgNotifica(!0,a.message,!0,!1)):msgNotifica(!1,a.message,!0,!1)},error:function(t){ajaxFormError(t)}})},deleteImage=function(e,a,o){t.ajax({type:"POST",dataType:"json",headers:{"X-CSRF-TOKEN":o},url:a,data:{_method:"delete"},success:function(a){1==a.success?(t("#img-"+e).remove(),msgNotifica(!0,a.message,!0,!1)):msgNotifica(!1,a.message,!0,!1)},error:function(t){ajaxFormError(t)}})},t("body").on("click","#btn-upload",function(e){t(this).parents("#form-image").ajaxForm(o)});var o={beforeSend:function(){setBtn(4,"Aguarde",!1,"loader","btn-upload",!1,"silver")},success:function(e){1==e.success?(setBtn(1,ac,!0,"icon-cloud-upload","btn-upload"),"create"==e.ac&&t("#gallery-"+e.idm).prepend('<li id="img-'+e.id+'"><img src="'+e.path+'" class="framed"><div class="controls"><span id="btns-'+e.id+'" class="button-group compact children-tooltip"><button id="status-'+e.id+'" onclick="'+e.url_status+'" class="'+e.class+'" title="'+e.btn.status+'"></button><button id="edit-'+e.id+'" onclick="'+e.url_edit+'" class="button" title="'+e.btn.edit+'">'+e.btn.edit+'</button><button id="delete-'+e.id+'" onclick="'+e.url_delete+'" class="button icon-trash red-gradient" title="'+e.btn.delete+'"></button></span></div></li>'),"update"==e.ac&&t("#img-"+e.id).html('<img src="'+e.path+'" class="framed"><div class="controls"><span id="btns-'+e.id+'" class="button-group compact children-tooltip"><button id="status-'+e.id+'" onclick="'+e.url_status+'" class="'+e.class+'" title="'+e.btn.status+'"></button><button id="edit-'+e.id+'" onclick="'+e.url_edit+'" class="button" title="'+e.btn.edit+'">'+e.btn.edit+'</button><button id="delete-'+e.id+'" onclick="'+e.url_delete+'" class="button icon-trash red-gradient" title="'+e.btn.delete+'"></button></span></div>'),fechaModal(),msgNotifica(!0,e.message,!0,!1)):msgNotifica(!1,e.message,!0,!1)},complete:function(t){setBtn(4,"Upload",!0,"icon-cloud-upload","btn-upload",!1,"blue")},error:function(t){ajaxFormError(t),setBtn(4,"Upload",!0,"icon-cloud-upload","btn-upload",!1,"blue")}}}}(jQuery);
