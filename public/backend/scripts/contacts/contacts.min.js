!function(a,e){a.fn.loadTableContacts=function(){var e=Handlebars.compile(a("#painel-"+tableContact.id).html()),t=a("#"+tableContact.id).DataTable({processing:!0,serverSide:!0,ajax:{url:tableContact.url,type:"POST",dataType:"json",headers:{"X-CSRF-TOKEN":tableContact.token}},sScrollX:!0,sScrollXInner:"100%",buttons:["reset"],sPaginationType:"full_numbers",iDisplayLength:tableContact.limit,sDom:'CB<"clear"><"dataTables_header"lfr>t<"dataTables_footer"ip>',fnDrawCallback:function(e){tableContact.tableStyled||(a("#"+tableContact.id).closest(".dataTables_wrapper").find(".dataTables_length select").addClass("select "+tableContact.color+" glossy").styleSelect(),a("#btn-reset").addClass(tableContact.color+" glossy"),tableContact.tableStyled=!0)},columns:[{data:"created_at"},{data:"name"},{data:"subject"},{data:"message"},{data:"client",className:"align-center"},{data:"send",className:"align-center"},{data:null,className:"details-control",orderable:!1,searchable:!1,defaultContent:""}],order:[[0,"desc"]]});a("#"+tableContact.id).on("click",tableContact.openDetails,function(){if(event.target===this){var s=a(this).closest("tr"),n=t.row(s);n.child.isShown()?(n.child.hide(),s.removeClass("shown"),s.children().removeClass(tableContact.colorSel)):(n.child(e(n.data())).show(),s.addClass("shown"),s.children().addClass(tableContact.colorSel))}}),a(".dataTables_filter input").unbind().bind("input",function(a){(this.value.length>=3||13==a.keyCode)&&t.search(this.value).draw(),""==this.value&&t.search("").draw()}),openResponse=function(e,t){1==e?a("#response-email-"+t).show():a("#response-email-"+t).hide()},responseMail=function(e,t,s){var n=a("#"+e),o=n.attr("action");a.ajax({type:"POST",dataType:"json",url:o,data:n.serialize(),beforeSend:function(){setBtn(4,t,!1,"loader","btn-response",!1,"silver")},success:function(a){1==a.success?refreshContact(a.id,a.refresh):setBtn(4," "+s,!0,"icon-paper-plane","btn-response",!1,"blue"),msgNotifica(a.success,a.message,!0,!1)},error:function(a){setBtn(4," "+s,!0,"icon-paper-plane","btn-response",!1,"blue"),ajaxFormError(a)}})},refreshContact=function(e,t){a.ajax({url:t,success:function(t){a("#load-contact-"+e).html(t)},error:function(a){ajaxFormError(a)}})},statusMail=function(e,t){a.ajax({type:"POST",dataType:"json",url:base+"/contacts/"+e+"/status",data:{status:t},headers:{"X-CSRF-TOKEN":tableContact.token},success:function(s){1==t?(a("#icon-star-"+e).addClass("orange"),a("#icon-flag-"+e).removeClass("red")):(a("#icon-star-"+e).removeClass("orange"),a("#icon-flag-"+e).addClass("red")),msgNotifica(s.success,s.message,!0,!1)},error:function(a){ajaxFormError(a)}})},spamContact=function(e){a.ajax({type:"POST",dataType:"json",url:base+"/contacts/"+e+"/spam",headers:{"X-CSRF-TOKEN":tableContact.token},success:function(a){1==a.success&&t.ajax.reload(),msgNotifica(a.success,a.message,!0,!1)},error:function(a){ajaxFormError(a)}})}}}(jQuery);
