!function(e,t){e.fn.loadTableProducts=function(t,a,r){var o=e("#"+t).DataTable({processing:!0,serverSide:!0,sPaginationType:"full_numbers",sScrollX:!0,sScrollXInner:"100%",lengthChange:!1,info:!1,ajax:{url:r,type:"POST",dataType:"json",headers:{"X-CSRF-TOKEN":tableOrderProduct.token}},columns:[{data:null,className:"details-control",orderable:!1,searchable:!1,defaultContent:""},{data:"image"},{data:"code"},{data:"color"}],order:[[2,"desc"]]}),n=[];e("#"+t+" tbody").on("click","tr td.details-control",function(){var t=e(this).closest("tr"),a=o.row(t),r=e.inArray(t.attr("id"),n);a.child.isShown()?(t.removeClass("details"),a.child.hide(),n.splice(r,1)):(t.addClass("details"),a.child(htmlOrderItem(a.data())).show(),-1===r&&n.push(t.attr("id")))}),o.on("draw",function(){e.each(n,function(t,a){e("#"+a+" td.details-control").trigger("click")})}),e(".dataTables_filter input").unbind().bind("input",function(e){(this.value.length>=3||13==e.keyCode)&&o.search(this.value).draw(),""==this.value&&o.search("").draw()}),addOrderItem=function(t,r){var o=e("#"+t),n=o.attr("action");e.ajax({type:"POST",dataType:"json",url:n,data:o.serialize(),beforeSend:function(){setBtn(4,tableOrderProduct.txtLoader,!1,"loader","btn-modal-"+r,!1,"silver")},success:function(e){1==e.success?(reloadOrderItem(a,e.reload),msgNotifica(!0,e.message,!0,!1),fechaModal()):msgNotifica(!1,e.message,!0,!1),setBtn(4,tableOrderProduct.txtSave,!0,"icon-publish","btn-modal-"+r,!1,"blue")},error:function(e){setBtn(4,tableOrderProduct.txtSave,!0,"icon-publish","btn-modal-"+r,!1,"blue"),ajaxFormError(e)}})}},htmlOrderItem=function(e){var t="addOrderItem('form-list-items-"+e.id+"','"+e.id+"')";return'<form id="form-list-items-'+e.id+'" method="post" action="'+e.action+'" class="columns" onsubmit="return false"><input type="hidden" name="_token" value="'+e.token+'"><fieldset class="fieldset"><legend class="legend">Selecione a Grade</legend>'+e.grids+'<div class="align-right"><button id="btn-modal-'+e.id+'" onclick="'+t+'" class="button blue-gradient icon-publish" title="Salvar">Salvar</button></div></fieldset></form><br/>'},updateOrderItem=function(t,a,r,o){var n=e("#"+t),d=n.attr("action");e.ajax({type:"POST",dataType:"json",url:d,data:n.serialize(),beforeSend:function(){setBtn(4,tableOrderProduct.txtLoader,!1,"loader","btn-modal-"+a,!1,"silver")},success:function(e){1==e.success?(reloadOrderItem(r,o),msgNotifica(!0,e.message,!0,!1),fechaModal()):msgNotifica(!1,e.message,!0,!1),setBtn(4,tableOrderProduct.txtSave,!0,"icon-publish","btn-modal-"+a,!1,"blue")},error:function(e){setBtn(4,tableOrderProduct.txtSave,!0,"icon-publish","btn-modal-"+a,!1,"blue"),ajaxFormError(e)}})},reloadOrderItem=function(t,a){e.ajax({url:a,success:function(a){e("#list-"+t).html(a)},error:function(e){msgNotifica(!1,"Houve um erro no servidor",!0,!1)}})},deleteOrderItem=function(t,a){e.modal.confirm(tableOrderProduct.txtRemove+"?",function(){e.ajax({type:"DELETE",dataType:"json",headers:{"X-CSRF-TOKEN":tableOrderProduct.token},url:a,success:function(a){1==a.success?(e("#"+t).hide(),msgNotifica(!0,a.message,!0,!1)):msgNotifica(!1,a.message,!0,!1)},error:function(e){ajaxFormError(e)}})},function(){e.modal.alert(tableOrderProduct.txtCancel)})}}(jQuery);
