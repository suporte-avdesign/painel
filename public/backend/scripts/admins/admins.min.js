!function(e,t){e.fn.loadTableAdmins=function(){var t=Handlebars.compile(e("#painel-"+tableAdmin.id).html()),a=e("#"+tableAdmin.id).DataTable({processing:!0,serverSide:!0,ajax:{url:tableAdmin.url_admins,type:"POST",dataType:"json",headers:{"X-CSRF-TOKEN":tableAdmin.token}},sScrollX:!0,sScrollXInner:"100%",buttons:["reset"],sPaginationType:"full_numbers",iDisplayLength:tableAdmin.limit,sDom:'CB<"clear"><"dataTables_header"lfr>t<"dataTables_footer"ip>',fnDrawCallback:function(t){tableAdmin.tableStyled||(e("#"+tableAdmin.id).closest(".dataTables_wrapper").find(".dataTables_length select").addClass("select "+tableAdmin.color+" glossy").styleSelect(),e("#btn-reset").addClass(tableAdmin.color+" glossy"),tableAdmin.tableStyled=!0)},columns:[{data:"name",className:"align-left"},{data:"profile",className:"align-right"},{data:"active",className:"align-center"},{data:"phone",className:"align-right"},{data:null,className:"details-control",orderable:!1,searchable:!1,defaultContent:""}],order:[[0,"asc"]]});e("#"+tableAdmin.id).on("click",tableAdmin.openDetails,function(){if(event.target===this){var s=e(this).closest("tr"),l=a.row(s);l.child.isShown()?(l.child.hide(),s.removeClass("shown"),s.children().removeClass(tableAdmin.colorSel)):(l.child(t(l.data())).show(),s.addClass("shown"),s.children().addClass(tableAdmin.colorSel))}}),formAdmin=function(t){var s,l=e("#form-"+tableAdmin.id),i=l.attr("action");s="create"==t?tableAdmin.txtSave:tableAdmin.txtUpdate,e.ajax({type:"POST",dataType:"json",url:i,data:l.serialize(),beforeSend:function(){setBtn(4,"Aguarde",!1,"loader","btn-modal",!1,"silver")},success:function(e){1==e.success?(setBtn(4,s,!0,"icon-publish","btn-modal",!1,"blue"),a.ajax.reload(),msgNotifica(!0,e.message,!0,!1),fechaModal()):(setBtn(4,s,!0,"icon-publish","btn-modal",!1,"blue"),msgNotifica(!1,e.message,!0,!1))},error:function(e){setBtn(4,s,!0,"icon-publish","btn-modal",!1,"blue"),ajaxFormError(e)}})},deleteAdmin=function(t,s){e.modal.confirm(tableAdmin.txtConfirm+" "+s+"?",function(){e.ajax({type:"DELETE",dataType:"json",headers:{"X-CSRF-TOKEN":tableAdmin.token},url:t,success:function(e){1==e.success?(a.ajax.reload(),msgNotifica(!0,e.message,!0,!1)):msgNotifica(!1,e.message,!0,!1)},error:function(e){msgNotifica(!1,tableAdmin.txtError,!0,!1)}})},function(){e.modal.alert(tableAdmin.txtCancel)})},adminAccessTxt=function(t,a,s,l,i){if("delete-all"==t||"delete"==t){if("delete-all"==t){var n=filesAccess.txtConfirmAll+s;setBtn(4,filesAccess.txtLoader,!1,"loader","del-all-"+a,!1,"silver")}else n=filesAccess.txtConfirm+i+" de "+s;e.modal.confirm(n,function(){e.ajax({type:"POST",dataType:"json",data:{ac:t,user:s,path:l,_token:filesAccess.token},url:filesAccess.url,success:function(s){1==s.success?"delete"==t?(e("#"+i+"_"+a).hide(),e("#return_"+a).html(""),e("#info_"+a).show()):(e("#del-all-"+a).hide(),e("#return_"+a).hide(),e("#files_"+a).hide()):"delete-all"==t&&setBtn(4,filesAccess.txtDelete,!0,"icon-trash ","del-all-"+a,!1,"red"),msgNotifica(s.success,s.message,!0,!1)},error:function(e){msgNotifica(!1,filesAccess.txtError,!0,!1),"delete-all"==t&&setBtn(4,filesAccess.txtDelete,!0,"icon-trash ","btn-modal",!1,"red")}})},function(){e.modal.alert(filesAccess.txtCancel),setBtn(4,filesAccess.txtDelete,!0,"icon-trash ","del-all-"+a,!1,"red")})}else e.ajax({type:"POST",dataType:"html",data:{ac:t,user:s,path:l,_token:filesAccess.token},url:filesAccess.url,success:function(t){e("#return_"+a).html(t),e("#info_"+a).hide()},error:function(e){ajaxFormError(e)}})},openPermissions=function(t,a){e.ajax({url:a,dataType:"html",beforeSend:function(){e("#loader-"+t).show()},success:function(a){e("#loader-"+t).hide(),e("#permisions-"+t).html(a)},error:function(a){e("#loader-"+t).hide(),ajaxFormError(a)}})},e.fn.changePermission=function(t,a){var s;1==e("#check_"+t).val()?(e("#check_"+t).val(0),s="remove"):(e("#check_"+t).val(1),s="insert"),e.ajax({type:"POST",headers:{"X-CSRF-TOKEN":tableAdmin.token},data:{_method:"put",ac:s,id:t},url:a,dataType:"json",success:function(e){1==e.success?msgNotifica(!0,e.message,!0,!1):msgNotifica(!1,e.message,!0,!1)},error:function(e){msgNotifica(!1,"Houve um erro no servidor",!0,!1)}})},preview_image=function(t,a){e("#image_preview_"+t).html("");for(var s=document.getElementById("upload_file").files.length,l=0;l<s;l++)e("#image_preview_"+t).append('<img src="'+URL.createObjectURL(event.target.files[l])+'" width="'+a+'">');e("#btn-upload-submit").show()},statusImage=function(t,a,s){e.ajax({type:"POST",dataType:"json",headers:{"X-CSRF-TOKEN":s},url:a,data:{_method:"put"},beforeSend:function(){e("#status-"+t).attr("class","button disabled")},success:function(a){1==a.success?(e("#status-"+t).attr("class",a.class),msgNotifica(!0,a.message,!0,!1)):msgNotifica(!1,a.message,!0,!1)},error:function(e){ajaxFormError(e)}})},deleteImage=function(t,a,s){e.ajax({type:"POST",dataType:"json",headers:{"X-CSRF-TOKEN":s},url:a,data:{_method:"delete"},success:function(a){1==a.success?(e("#btn-add-image-admin").show(),e("#img-"+t).remove(),msgNotifica(!0,a.message,!0,!1)):msgNotifica(!1,a.message,!0,!1)},error:function(e){ajaxFormError(e)}})},e("body").on("click","#btn-upload",function(t){e(this).parents("#form-image").ajaxForm(s)});var s={beforeSend:function(){setBtn(4,"Aguarde",!1,"loader","btn-upload",!1,"silver")},success:function(t){1==t.success?(setBtn(1,ac,!0,"icon-cloud-upload","btn-upload"),"create"==t.ac&&e("#gallery-"+t.idm).prepend('<li id="img-'+t.id+'"><img src="'+t.path+'" class="framed"><div class="controls"><span id="btns-'+t.id+'" class="button-group compact children-tooltip"><button id="status-'+t.id+'" onclick="'+t.url_status+'" class="'+t.class+'" title="'+t.btn.status+'"></button><button id="edit-'+t.id+'" onclick="'+t.url_edit+'" class="button" title="'+t.btn.edit+'">'+t.btn.edit+'</button><button id="delete-'+t.id+'" onclick="'+t.url_delete+'" class="button icon-trash red-gradient" title="'+t.btn.delete+'"></button></span></div></li>'),"update"==t.ac&&e("#img-"+t.id).html('<img src="'+t.path+'" class="framed"><div class="controls"><span id="btns-'+t.id+'" class="button-group compact children-tooltip"><button id="status-'+t.id+'" onclick="'+t.url_status+'" class="'+t.class+'" title="'+t.btn.status+'"></button><button id="edit-'+t.id+'" onclick="'+t.url_edit+'" class="button" title="'+t.btn.edit+'">'+t.btn.edit+'</button><button id="delete-'+t.id+'" onclick="'+t.url_delete+'" class="button icon-trash red-gradient" title="'+t.btn.delete+'"></button></span></div>'),!0===t.auth&&e("#avatar").attr("src",t.path),e("#btn-add-image-admin").hide(),fechaModal(),msgNotifica(!0,t.message,!0,!1)):msgNotifica(!1,t.message,!0,!1)},complete:function(e){setBtn(4,"Upload",!0,"icon-cloud-upload","btn-upload",!1,"blue")},error:function(e){ajaxFormError(e),setBtn(4,"Upload",!0,"icon-cloud-upload","btn-upload",!1,"blue")}}}}(jQuery);
